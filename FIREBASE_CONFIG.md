# Firebase Configuration Guide

## Overview
This project uses Firebase for authentication and messaging across all platforms (Web, Android, iOS, Windows, macOS).

## Firebase Project Details
- **Project ID**: `dpeoij`
- **Project Number**: `92139939502`

## Platform Configurations

### Web
- **API Key**: `AIzaSyDmXiH4OxKMvUea1LN1HsQEzjh1lrgRNvM`
- **App ID**: `1:92139939502:web:fa42f40c4e94fa204c2f3f`
- **Auth Domain**: `dpeoij.firebaseapp.com`
- **Storage Bucket**: `dpeoij.firebasestorage.app`
- **Measurement ID**: `G-LK8JJTYK1J`

### Android
- **API Key**: `AIzaSyBwSl21NLE4aCFYkFPg2evB7QebWbOXWCk`
- **App ID**: `1:92139939502:android:bb633e846a512d154c2f3f`
- **Package Name**: `com.buildx.app`
- **SHA1 Certificate Hash**: `808116c68d1e7f888577e9e9de058d18c1013e79`
- **google-services.json**: Located at `android/app/google-services.json`

### iOS/macOS
- **API Key**: `AIzaSyAiz0CZoEGt0yZa9lEy3RnNAtpzsd_9vyk`
- **App ID**: `1:92139939502:ios:a4a676e6f59d8aa14c2f3f`
- **Bundle ID**: `com.psyche.kelivo`
- **OAuth Client ID**: `92139939502-qgqcodld4m9lv3o44bs9jpcbtf071jf0.apps.googleusercontent.com`

### Windows
- **API Key**: `AIzaSyDmXiH4OxKMvUea1LN1HsQEzjh1lrgRNvM`
- **App ID**: `1:92139939502:web:000ec8b89de13b4f4c2f3f`
- **Auth Domain**: `dpeoij.firebaseapp.com`
- **Measurement ID**: `G-TSHY6SVBDF`

## Environment Setup

### Required .env Variables
Create a `.env` file in the project root with:

```dotenv
# Firebase Configuration - Web
FIREBASE_API_KEY=AIzaSyDmXiH4OxKMvUea1LN1HsQEzjh1lrgRNvM
FIREBASE_AUTH_DOMAIN=dpeoij.firebaseapp.com
FIREBASE_PROJECT_ID=dpeoij
FIREBASE_STORAGE_BUCKET=dpeoij.firebasestorage.app
FIREBASE_MESSAGING_SENDER_ID=92139939502
FIREBASE_APP_ID=1:92139939502:web:fa42f40c4e94fa204c2f3f
FIREBASE_MEASUREMENT_ID=G-LK8JJTYK1J

# Google Sign-In Configuration
GOOGLE_OAUTH_CLIENT_ID=92139939502-isq8o1j9ujqo3ha92vjsphoe5cbu0v5o.apps.googleusercontent.com
```

## Authentication Methods

### Email/Password Authentication
- Available through Firebase Authentication
- Configured in `lib/features/auth/pages/login_page.dart`
- Error handling includes proper null checks for missing credentials

### Google Sign-In
- Requires Google OAuth credentials
- Configured across all platforms
- **Important**: On web, Google credentials may fail if Firebase SDK is not properly initialized
- Error handling added in `lib/features/auth/services/auth_service.dart` and `lib/features/auth/pages/login_page.dart`

## Troubleshooting

### "Null check operator used on a null value" Error
This typically occurs when:
1. Firebase is not properly initialized on the platform
2. Google Sign-In credentials (accessToken or idToken) are null
3. Firebase SDK is not included on the web platform

**Solution**:
- Verify Firebase is initialized in `main()` via `Firebase.initializeApp()`
- Check that `.env` file contains correct Firebase API keys
- Ensure Google OAuth is configured in Firebase Console
- The code now includes proper null checks and error messages

### Web Authentication Issues
For web authentication to work:
1. Ensure the app is served over HTTPS (required by browsers)
2. Add your web domain to Firebase Console under "Authorized Domains"
3. Verify `firebase_options.dart` contains correct web credentials
4. Check browser console for CORS or SDK initialization errors

## Configuration Files

### Generated by FlutterFire CLI
- `lib/firebase_options.dart` - Auto-generated platform configurations
- `android/app/google-services.json` - Android Firebase config
- `ios/Runner/GoogleService-Info.plist` - iOS Firebase config (if available)

### Manual Configuration
- `lib/main.dart` - Firebase initialization
- `lib/features/auth/pages/login_page.dart` - Email/Google login UI
- `lib/features/auth/services/auth_service.dart` - Auth service with null checks

## Recent Updates (December 9, 2025)

1. **Added Null Checks**: Improved error handling in `auth_service.dart` and `login_page.dart`
2. **Optional .env Loading**: Main.dart now gracefully handles missing `.env` file
3. **Better Error Messages**: Authentication errors now show specific error reasons to users
4. **Firebase Credentials**: All platform credentials verified and up-to-date

## Next Steps

1. Add your authorized domains to Firebase Console if deploying on web
2. Test authentication on each platform before production release
3. Ensure all environment variables are properly configured on deployment platforms
4. Monitor Firebase Console for authentication failures

## Support

For Firebase configuration help, see:
- [Firebase Console](https://console.firebase.google.com/)
- [FlutterFire Documentation](https://firebase.flutter.dev/)
- [Google Sign-In Documentation](https://pub.dev/packages/google_sign_in)
